[
["index.html", "POLS 503: Advanced Quantitative Political Methodology: The Notes Chapter 1 Introduction", " POLS 503: Advanced Quantitative Political Methodology: The Notes Jeffrey B. Arnold 2016-04-13   Chapter 1 Introduction hello, world!  "],
["review-of-statistics.html", "Chapter 2 Review of Statistics 2.1 Terms 2.2 Estimators and Estimates 2.3 Example", " Chapter 2 Review of Statistics Before getting started it is worth recalling a few concepts and terms from statistics.  2.1 Terms  2.1.1 Statistic A statistic is a function of sample data. Let \\(x = (x_1, \\dots, x_N)\\) be our sample data. Examples of statistics include:  mean \\(\\mean(x) = \\frac{1}{N} \\sum_{i = 1}^{N} x_i\\)  variance \\(\\Var(x) = \\frac{1}{n - 1} \\sum_{i = 1}^{N} (x_i - mean(x))^2\\)   Statistics do not need to be single numbers. The sample data \\(x\\) is, itself statistic, albeit output of the use.   2.1.2 Parameter A parameter is a function of the population. While the value of a statistic depends on a particular sample drawn from the population, the value of a parameter is fixed. Perhaps the most commonly used parameter is the population mean, \\(\\E(X)\\). Another example is the population variance, \\(\\Var(X) = \\E((X - E(X))^)\\). A single population can have many (infinite) parameters that we could consider, although in practice, inference usually is concerned with only a few of these, such as the mean or variance, or parameters by which a distribution is commonly parameterized. A parameter usually represents one particular aspect of the population, not all the features of the population; like a a statistic, it throws away information in doing so. And like a statistic, by throwing away this information, we will often be able to proceed While statistics are random variables, parameters are a fixed feature of the population. In statistical inference we use statistics of the sample to make inferences about parameters of the population.    2.2 Estimators and Estimates An estimator is a statistic (function of the sample data) used to estimate a population parameter. An estimate is the value (number) of an estimator for a specific sample. Many statistics can be used as an estimator for a given parameter, but not all of them will be good estimators. For example, the sample mean, sample median, sample variance, and always guessing 0 are all estimators of the population mean. However, we will prefer using the sample mean as the estimator of the population parameter, for reasons other than it having the sample name To understand why we prefer some estimators over others, we need to consider the sampling distribution of the statistic.  2.2.1 Sampling distribution Since a statistic is a function of the sample, it varies sample to sample. The distribution of the sample statistic over repeated samples from the sample population is called the sampling distribution.   2.2.2 Standard Error The standard deviation of a sampling distribution is called the standard error. The larger the standard error, the variable the statistic is acrros samples. All else equal, it is preferrable to have a statistic with a lower standard error, since it is less liable to vary wildly acrros samples. Since the standard error is a property of the population distribution from which the samples were drawn, this means that the standard error of a statistic is a parameter. But, then, what are the standard errors that are returned by statistical software? The standard errors that are calculated from a sample are an estimate of the population standard error. This means that in addition to the properties of the statistic of interest, we can, and often have to evaluate, different methods of calculating the standard error of the stampling distribution of that statistic.   2.2.3 Methods for evaluating statistics  Bias Variance Mean squared error Consistency Robustness / resilience     2.3 Example TODO   "],
["simple-linear-regression.html", "Chapter 3 Simple Linear Regression 3.1 Representing the Relationship between two variables 3.2 Conditional Expectation Function 3.3 Population Linear Regression Function 3.4 Sample Linear Regression Function 3.5 Ordinary Least Squares 3.6 Properties of the OLS Estimator 3.7 Properties of the Estimator 3.8 Assumptions for unbiasedness and consistency of OLS 3.9 Hypothesis Tests for Regression 3.10 Confidence Intervals for Regression 3.11 Goodness of Fit 3.12 References", " Chapter 3 Simple Linear Regression  3.1 Representing the Relationship between two variables Many theories in social science is how two variables are related – Does turnout vary by types of mailers received? – Is the quality of political institutions related to average incomes? - Does conflict mediation help reduce civil conflict?  Y - the dependent variable or outcome or regressand or left-hand-side variable or response – Voter turnout – Log GDP per capita – Number of battle deaths X - the independent variable or explanatory variable or regressor or righthand-side variable or treatment or predictor – Social pressure mailer versus Civic Duty Mailer – Average Expropriation Risk – Presence of conflict mediation  A common goal of these analyses is to understand how \\(Y\\) varies as a function of \\(X\\),   3.2 Conditional Expectation Function There are many ways to summarize the relationship between two variables: visually with scatterplots, covariance, and correlation. When we want to describe an outcome or estimate the effect of a covariate on an outcome, one way to model this is through a conditional expectation—what is the expected value (mean) of the outcome for a given value of the covariate(s). The conditional expectation function (CEF), also called the regression function of \\(Y\\) given \\(X\\) is the function that gives the expected value (mean) of \\(Y\\) at various values of \\(x\\). It is denoted \\(\\E(Y | X = x)\\). Note that the CEF is a function of the population. In the same way that the expected value of a distribution is a parameter, the conditional expected values of the distribution given values of \\(x\\) is also a parameter. Like other parameters, the CEF throws away a lot of data. It does not describe all the ways that the distribution of \\(Y\\) changes as a function of \\(x\\); it only describes how the mean of \\(Y\\) changes as a function of \\(x\\).  3.2.1 Three uses of regression  Description - parsimonious summary of the data Prediction/Estimation/Inference - learn about parameters of the joint distribution of the data Causal Inference - evaluate counterfactuals     3.3 Population Linear Regression Function The simple (bivariate) linear regression, regression is linear regression with one outcome variable and one covariate, \\[ r(x) = \\E[Y | X = x] = \\beta_0 + \\beta_1 X \\] This describes a data generating process in the population where  Y : dependent variable (random variable) X : independent variable (random variable) \\(\\beta_0\\): population intercept \\(\\beta_1\\): popluation slope  We will want to estimate \\(\\beta_0\\) and \\(\\beta_1\\).   3.4 Sample Linear Regression Function The sample linear regression function is \\[ \\hat{r}(x_i) = \\hat{y}_i = \\hat\\beta_0 + \\hat\\beta_1 x_i \\] - _i : fitted or predicted value - _i - x_i : observed values of the predictors - \\(\\hat\\beta_0\\): estimated intercept - \\(\\hat\\beta_1\\): estimated slope - This also yields the residuals \\(\\hat\\epsilon_i\\), which are the difference between the observed value of \\(y_i\\) and the predicted value \\(\\hat{y}_i\\), \\[     \\hat\\epsilon_i = y_i - \\hat{y}_i     \\]   3.5 Ordinary Least Squares Ordinary least squares is an estimator of the slope an intercept of the regression line. It finds the slope and intercept that minimizes the sum of the squared residuals. The estimates \\[ \\begin{aligned}[t] (\\hat{\\beta}_0, \\hat{\\beta}_1) &amp;= \\argmin_{b_0, b_1} \\sum_{i = 1}^N (y_i - b_0 - b_1 x_i)^2 \\\\ &amp;= \\argmin_{b_0, b_1} \\sum_{i = 1}^N (y_i - \\hat{y_i})^2 \\\\ &amp;= \\argmin_{b_0, b_1} \\sum_{i = 1}^N \\hat{\\epsilon}_i^2 \\end{aligned} \\] where, \\(\\hat{y}_i\\) are the fitted values, \\[ \\hat{y}_i = b_0 + b_1 x_i \\] and \\(\\hat{\\epsilon}_i\\) are the esimated residuals, \\[ \\hat{\\epsilon}_i = y_i - \\hat{y}_i . \\] INSERT PLOT A nice feature of OLS is that that the solution to the minimization problem can be found analytically. The solutions to OLS are \\[ \\begin{aligned}[t] \\hat{\\beta}_0 &amp;= \\bar{y} - \\hat{\\beta}_1 \\bar{x} \\\\ \\hat{\\beta_1} &amp;= \\frac{\\sum_{i = 1}^n (x_i - \\bar{x})^2 (y_i - \\bar{y})}{\\sum_{i = 1}^n (x_i - \\bar{x})^2} = \\frac{\\cov(x, y)}{\\Var{x}} \\end{aligned} \\] In other words the regression slop is the covariance between the outcome and predictor variable, scaled by the variance of the predictor variable. Since \\(\\cor(x, y) = \\cov(x, y) / (\\sd{x} \\sd{y})\\), the regression slope can be expressed as a function of the correlation between \\(x\\) and \\(y\\), \\[ \\hat{y} = \\cor(x, y) \\cdot \\frac{\\sd{x}}{\\sd{y}} . \\] Questions:  How does the slope of the regression vary with the sample correlation? covariance? What happens when \\(x\\) doesn’t vary? In other words \\(x_1 = x_2 = \\dots = x_n\\). Answer this using the equation, and by sketching what this data and the regression line would look like? What happens when \\(y\\) doesn’t vary?  In more complicated problems, the solutions have to be found through an iterative optimization problem.  3.5.1 Mechanical properties of the OLS statistic These properties are related to the algorithm used the estimate OLS, and are not directly related to how well OLS works as an estimator. These properties follow directly from the first-order conditions used to find the OLS estimates.  Residuals are zero on average. And by implications, the residuals sum to zero. \\[ \\frac{1}{N} \\sum_{i = 1}^N \\hat{\\epsilon}_i = 0 \\] The residuals are uncorrelated with the covariate, \\[ \\cov(x_i, \\hat{\\epsilon}_i) = 0 \\] The residuals are uncorrelated with the fitted values \\[ \\cov(\\hat{y}_i, \\hat{\\epsilon}_i) = 0 \\] The regression line goes through \\((\\bar{y}, \\bar{x})\\).  Note that 2 and 3 are properites of the estimated residuals, not the population residuals. If the population residuals are correlated with the covariate or outcome, then OLS estimator will have problems.   3.5.2 OLS slope is a weighted sum of the outcomes The OLS estimator for the slope, \\(\\hat{\\beta}_1\\), can be written as a weighted sum of the outcomes, \\[ \\hat{\\beta}_1 = \\sum_{i = 1}^n w_i y_i \\] where \\[ w_i = \\frac{(x_i - \\bar{x})^2}{\\sum_{i = 1}^n (x_i - \\bar{x})^2} \\] This is important for several reasons. Even though the regression line includes all observations in its calculation, not all observations are equally important in determining the regression line. Those observations far from the average value of \\(x\\) are given more weight.[^ch2-outlier] See the paper by XXXX on panel data and regression weighting. This also implies that \\(\\hat{\\beta}\\) is a random variable, since it is the sum of random variables, \\(Y_i\\). For the derivation, see http://www.mattblackwell.org/files/teaching/s07-simple-regression.pdf    3.6 Properties of the OLS Estimator Remember, OLS is a statistic—a mechanical function of the data. We plug in data and get a result. It may be more complicated than sample means, variances, medians, or other summary stats seen earlier, but it is analgous. Since it is a function of the sample data, an the sample is a random variable, the OLS statistic has a sampling distribution. This sampling distribution will determine how well the OLS statistic works as an estimator of the population linear regression line. INSERT FAKE DATA EXAMPLE   3.7 Properties of the Estimator  Unbiased Consistent Asymptotically normal Efficiency. An efficient estimator is the estimator with the lowest standard error. OLS is BLUE—the Best Linear Unbiased Estimator. This is proven by the Gauss-Markov Theorem. For the set of the class of linear, unbiased, estimators (with a few regularity conditions), OLS is the efficient estimator.    OLS Is BLUE (Best Linear Unbiased Estimator)    3.8 Assumptions for unbiasedness and consistency of OLS  Linearity Random (i.i.d.) sample Variation in \\(x_i\\) Zero conditional mean of the errors  These assumptions are about using the OLS statistic as an estimator of the population linear regression line. The only assumption that is necessary to calculate a sample regression line is variation in \\(x\\). If the other assumptions are not met, then the sample OLS statistic can be calculated, but it may be a poor estimator of the population regression line.   3.9 Hypothesis Tests for Regression   3.10 Confidence Intervals for Regression   3.11 Goodness of Fit How well does the regression line fit the data? There are two commonly used statistics to judge this.  prediction error, or the standard error of the regression \\(R^2\\) (R-squared) and adjusted \\(R^2\\)  \\[ SST = \\sum_{i = 1}^n (y_i - \\bar{y})^2 \\] \\[ SSR = \\sum_{i = 1}^n (y_i - \\hat{y})^2 \\] \\(R^2\\) is a form of model comparison. It compares the regression against a benchmark null model, which in this case is a model with only the intercept \\(y_i = \\beta_0 = \\bar{y}\\). Some propertie of \\(R\\)-squared:  \\(R^2\\) implies no relationship. If \\(R^2 = 0\\), then \\(\\beta_0 = 0\\). \\(R^2\\) implies a perfect linear fit \\(R^2\\) is the correlation squared.    3.12 References  Much of this is taken from Matthew Blackwell lecture notes for Govt 2002 http://www.mattblackwell.org/files/teaching/s07-simple-regression.pdf Tobias Funke meme http://memegenerator.net/instance2/5082792. Generated by Jeffrey Arnold. Hat-tip to Brenton Kenkel for the refence. http://bkenkel.com/psci8357/notes/02-reintroduction.pdf.    "],
["multiple-regression.html", "Chapter 4 Multiple Regression 4.1 Multiple linear regression in matrix form 4.2 No perfect collinearity 4.3 Expected values of vectors 4.4 OLS is unbiased 4.5 Variance-covariance matrix of random vectors 4.6 Matrix algebra review 4.7 Vectors 4.8 Vector examples 4.9 Transpose 4.10 Transposing vectors 4.11 Write matrices as vectors 4.12 Addition and subtraction 4.13 Scalar multiplication 4.14 The linear model with new notation 4.15 Matrix multiplication by a vector 4.16 Matrix multiplication 4.17 Special multiplications 4.18 Special matrices and jargon", " Chapter 4 Multiple Regression  4.1 Multiple linear regression in matrix form Let \\(\\widehat{\\boldsymbol{\\beta}}\\) be the matrix of estimated regression coefficients: \\[\\widehat{\\boldsymbol{\\beta}} = \\left[ \\begin{array}{c}     \\widehat{\\beta}_0 \\\\     \\widehat{\\beta}_1 \\\\     \\vdots \\\\     \\widehat{\\beta}_k     \\end{array} \\right]\\] In matrix form, the linear regression can be written as \\[\\widehat{\\vec{y}} = \\mat{X}\\widehat{\\boldsymbol{\\beta}}\\] It might be helpful to see this again more written out: \\begin{small} \\[\\widehat{\\vec{y}} = \\left[ \\begin{array}{c}     \\widehat{y}_1 \\\\     \\widehat{y}_2 \\\\     \\vdots \\\\     \\widehat{y}_n     \\end{array} \\right]  = \\mat{X}\\widehat{\\boldsymbol{\\beta}} = \\left[ \\begin{array}{c}     1\\widehat{\\beta}_0  + x_{11}\\widehat{\\beta}_1 +  x_{12}\\widehat{\\beta}_2 + \\dots + x_{1K} \\widehat{\\beta}_K \\\\     1\\widehat{\\beta}_0 + x_{21}\\widehat{\\beta}_1 + x_{22}\\widehat{\\beta}_2  + \\dots + x_{2K}\\widehat{\\beta}_K \\\\    \\vdots  \\\\    1\\widehat{\\beta}_0 + x_{n1}\\widehat{\\beta}_1 + x_{n2}\\widehat{\\beta}_2  + \\dots + x_{nK}\\widehat{\\beta}_K \\end{array} \\right] \\] \\end{small}  4.1.1 Residuals We can easily write the residuals in matrix form: \\[\\widehat{\\mat\\hat{\\epsilon}} = \\vec{y} - \\mat{X}\\widehat{\\boldsymbol{\\beta}}\\] Our goal as usual is to minimize the sum of the squared residuals, which we saw earlier we can write: \\[\\widehat{\\vec\\hat{\\epsilon}}&#39;\\widehat{\\vec\\hat{\\epsilon}} = (\\vec{y} - \\mat{X}\\widehat{\\boldsymbol{\\beta}})&#39;(\\vec{y} - \\mat{X}\\widehat{\\vec{\\beta}})\\]   4.1.2 OLS estimator in matrix form  By finding the values of \\(\\widehat{\\boldsymbol{\\beta}}\\) that minimizes the sum of the squared residuals, we arrive at the following formula for the OLS estimator:  \\[\\mat{X}&#39;\\mat{X}\\widehat{\\boldsymbol{\\beta}} = \\mat{X}&#39;\\vec{y}\\]  In order to isolate \\(\\widehat{\\boldsymbol{\\beta}}\\), we need to move the \\(\\mat{X}&#39;\\mat{X}\\) term to the other side of the equals sign. -We’ve learned about matrix multiplication, but what about matrix “division”?    4.1.3 Scalar inverses What is division in its simplest form? \\(\\frac{1}{a}\\) is the value such that \\(a\\frac{1}{a} = 1\\): For some algebraic expression: \\(au = b\\), let’s solve for \\(u\\): \\[\\begin{aligned} \\frac{1}{a}au &amp;= \\frac{1}{a}b\\\\ u &amp;= \\frac{b}{a}\\\\ \\end{aligned}\\] Need a matrix version of this: \\(\\frac{1}{a}\\).   4.1.4 Matrix inverses Definition: If it exists, the inverse of square matrix \\(\\mat{A}\\), denoted \\(\\mat{A}^{-1}\\), is the matrix such that \\(\\mat{A}^{-1}\\mat{A} = \\mat{I}\\). We can use the inverse to solve (systems of) equations: \\[\\begin{aligned} \\mat{A}\\vec{\\hat{\\epsilon}} &amp;= \\vec{b} \\\\ \\mat{A}^{-1}\\mat{A}\\vec{\\hat{\\epsilon}} &amp;= \\mat{A}^{-1}\\vec{b} \\\\ \\mat{I}\\vec{\\hat{\\epsilon}} &amp;= \\mat{A}^{-1}\\vec{b} \\\\ \\vec{\\hat{\\epsilon}} &amp;= \\mat{A}^{-1}\\vec{b} \\\\ \\end{aligned}\\] If the inverse exists, we say that \\(\\mat{A}\\) is invertible, nonsingular, or nondegenerate. Not his implies that not all matrices are invertible. If a matrix is not invertible it is called singular or degenerate. All non-square matrices are not invertible. Square are invertible if all of its columns are linearly independent.   4.1.5 Inference   4.1.6 Back to OLS Let’s assume, for now, that the inverse of \\(\\mat{X}&#39;\\math{X}\\) exists (we’ll come back to this) Then we can write the OLS estimator as the following: \\[\\widehat{\\boldsymbol{\\beta}} = (\\mat{X}&#39;\\mat{X})^{-1}\\mat{X}&#39;\\vec{y}\\] Memorize this: “x prime x inverse x prime y” sear it into your soul.   4.1.7 Intuition for the OLS in matrix form  What’s the intuition here? First, note that the “numerator” \\(\\mat{X}&#39;\\vec{y}\\) is roughly composed of the covariances between the columns of \\(X\\) and \\(y\\) Next, the “denominator” \\(\\mat{X}&#39;\\mat{X}\\) is roughly composed of the sample variances and covariances of variables within \\(\\mat{X}\\) Thus, we have something like:  \\[\\widehat{\\mat{\\beta}} \\approx (\\text{variance of } \\math{X})^{-1} (\\text{covariance of } \\mat{X} \\text{ \\&amp; } \\vec{y})\\]  This is a rough sketch and isn’t strictly true, but it can provide intuition. We’re also sidestepping the issues of what the variance of a matrix is for now.    4.1.8 Most general OLS assumptions  Linearity: \\(\\vec{y} = \\mat{X} \\vec{\\beta} + \\vec{\\hat{\\epsilon}}\\) Random/iid sample: \\((y_i, \\mat{x}&#39;_i)\\) are a iid sample from the population. No perfect collinearity: \\(\\mat{X}\\) is an \\(n \\times (K + 1)\\) matrix with rank \\(K+1\\) Zero conditional mean: \\(\\E(\\vec{\\hat{\\epsilon}}|\\mat{X}) = \\mat{0}\\) Homoskedasticity: \\(\\text{var}(\\vec{\\hat{\\epsilon}}|\\mat{X}) = \\sigma_u^2 \\mat{I}_n\\) Normality: \\(\\vec{\\hat{\\epsilon}}|\\mat{X} \\sim N(\\mat{0}, \\sigma^2_u\\mat{I}_n)\\)     4.2 No perfect collinearity  In matrix form: \\(\\mat{X}\\) is an \\(n \\times (K+1)\\) matrix with rank \\(K+1\\) Definition The rank of a matrix is the maximum number of linearly independent columns. If \\(\\mat{X}\\) has rank \\(K+1\\), then all of its columns are linearly independent …and none of its columns are linearly dependent \\(\\implies\\) no perfect collinearity \\(\\mat{X}\\) has rank \\(K+1 \\implies (\\mat{X}&#39;\\mat{X})\\) is invertible Just like variation in \\(X\\) led us to be able to divide by the variance in simple OLS    4.3 Expected values of vectors  The expected value of the vector is the expected value of its entries. Using the zero mean conditional error assumptions: \\[\\E[\\vec{\\hat{\\epsilon}} | \\mat{X}] = \\left[\\begin{array}{c} \\E[u_1 | \\mat{X}] \\\\ \\E[u_2|\\mat{X}] \\\\ \\vdots \\\\ \\E[u_n|\\mat{X}] \\end{array} \\right] = \\left[\\begin{array}{c} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{array} \\right] = \\mat{0}\\]    4.4 OLS is unbiased  Under matrix assumptions 1-4, OLS is unbiased for \\(\\boldsymbol{\\beta}\\): \\[\\E[\\widehat{\\boldsymbol{\\beta}}] = \\boldsymbol{\\beta}\\]    4.5 Variance-covariance matrix of random vectors  The homoskedasticity assumption is different: \\(\\text{var}(\\vec{\\hat{\\epsilon}}|\\mat{X}) = \\sigma_u^2 \\mat{I}_n\\) In order to investigate this, we need to know what the variance of a vector is. The variance of a vector is actually a matrix:  \\[\\text{var}[\\vec{\\hat{\\epsilon}}] = \\Sigma_u = \\left[ \\begin{array}{cccc} \\text{var}(u_1) &amp; \\text{cov}(u_1,u_2) &amp; \\dots &amp; \\text{cov}(u_1, u_n) \\\\ \\text{cov}(u_2,u_1) &amp; \\text{var}(u_2) &amp; \\dots &amp; \\text{cov}(u_2,u_n) \\\\  \\vdots &amp; &amp; \\ddots &amp; \\\\ \\cov(u_n,u_1) &amp; \\cov(u_n,u_2) &amp; \\dots &amp; \\text{var}(u_{n})  \\end{array} \\right]\\]  This matrix is symmetric since \\(\\cov(u_i,u_j) = \\cov(u_i,u_j)\\)   4.5.1 Matrix version of homoskedasticity  Once again: \\(\\text{var}(\\vec{\\hat{\\epsilon}}|\\mathbf{X}) = \\sigma_u^2 \\mathbf{I}_n\\) Visually:  \\[\\text{var}[\\vec{\\hat{\\epsilon}}] =  \\sigma^2_u \\mathbf{I}_n= \\left[ \\begin{array}{ccccc} \\sigma_u^2 &amp; 0 &amp; 0 &amp; \\dots &amp; 0 \\\\  0 &amp; \\sigma_u^2 &amp; 0 &amp; \\dots &amp; 0 \\\\  &amp; &amp; &amp; \\vdots &amp; \\\\  0 &amp; 0 &amp; 0 &amp; \\dots &amp; \\sigma_u^2  \\end{array} \\right]\\]  In less matrix notation:  \\(\\text{var}(u_i) = \\sigma^2_u\\) for all \\(i\\) (constant variance) \\(\\cov(u_i,u_j) = 0\\) for all \\(i \\neq j\\) (implied by iid)     4.5.2 Sampling variance for OLS estimates  Under assumptions 1-5, the sampling variance of the OLS estimator can be written in matrix form as the following: \\[\\text{var}[\\widehat{\\boldsymbol{\\beta}}] = \\sigma^2_u(\\mathbf{X}&#39;\\mathbf{X})^{-1}\\] This matrix looks like this:  \\begin{center} \\begin{tabular}{c|ccccc}            &amp;    $\\widehat{\\beta}_0$ &amp;    $\\widehat{\\beta}_1$ &amp;    $\\widehat{\\beta}_2$ &amp;  $\\cdots$   &amp;    $\\widehat{\\beta}_K$ \\\\ \\hline    $\\widehat{\\beta}_0$ &amp; $\\text{var}[\\widehat{\\beta}_0]$ &amp; $\\cov[\\widehat{\\beta}_0,\\widehat{\\beta}_1]$ &amp;    $\\cov[\\widehat{\\beta}_0,\\widehat{\\beta}_2]$ &amp; $\\cdots$ &amp;  $\\cov[\\widehat{\\beta}_0,\\widehat{\\beta}_K]$   \\\\     $\\widehat{\\beta}_1$ &amp; $\\cov[\\widehat{\\beta}_0,\\widehat{\\beta}_1]$ &amp; $\\text{var}[\\widehat{\\beta}_1]$ &amp;     $\\cov[\\widehat{\\beta}_1,\\widehat{\\beta}_2]$ &amp;  $\\cdots$    &amp;  $\\cov[\\widehat{\\beta}_1,\\widehat{\\beta}_K]$ \\\\     $\\widehat{\\beta}_2$ &amp; $\\cov[\\widehat{\\beta}_0,\\widehat{\\beta}_2]$ &amp; $\\cov[\\widehat{\\beta}_1,\\widehat{\\beta}_2]$ &amp; $\\text{var}[\\widehat{\\beta}_2]$ &amp;   $\\cdots$  &amp;   $\\cov[\\widehat{\\beta}_2,\\widehat{\\beta}_K]$  \\\\     $\\vdots$    &amp;  $\\vdots$  &amp; $\\vdots$    &amp;  $\\vdots$    &amp;    $\\ddots$        &amp;    $\\vdots$        \\\\    $\\widehat{\\beta}_K$ &amp; $\\cov[\\widehat{\\beta}_0,\\widehat{\\beta}_K]$ &amp; $\\cov[\\widehat{\\beta}_K,\\widehat{\\beta}_1]$ &amp; $\\cov[\\widehat{\\beta}_K,\\widehat{\\beta}_2]$ &amp;     $\\cdots$       &amp; $\\text{var}[\\widehat{\\beta}_K]$ \\\\ \\end{tabular} \\end{center}   4.5.3 Inference in the general setting  Under assumption 1-5 in large samples: \\[\\frac{\\widehat{\\beta}_k - \\beta_k}{\\widehat{SE}[\\widehat{\\beta}_k]} \\sim N(0,1)\\] In small samples, under assumptions 1-6,  \\[\\frac{\\widehat{\\beta}_k - \\beta_k}{\\widehat{SE}[\\widehat{\\beta}_k]} \\sim t_{n - (K+1)}\\]  Thus, under the null of \\(H_0: \\beta_k = 0\\), we know that \\[\\frac{\\widehat{\\beta}_k}{\\widehat{SE}[\\widehat{\\beta}_k]} \\sim t_{n - (K+1)}\\] Here, the estimated SEs come from: \\[\\begin{aligned} \\widehat{\\text{var}}[\\widehat{\\boldsymbol{\\beta}}] &amp;= \\widehat{\\sigma}^2_u(\\mathbf{X}&#39;\\mathbf{X})^{-1} \\\\  \\widehat{\\sigma}^2_u &amp;= \\frac{\\widehat{\\vec{\\hat{\\epsilon}}}&#39;\\widehat{\\vec{\\hat{\\epsilon}}}}{n-(k+1)} \\end{aligned}\\]     4.6 Matrix algebra review  4.6.1 Matrices and vectors A matrix is a rectangular array of numbers. We say that a matrix is \\(n \\times K\\) (“\\(n\\) by \\(K\\)”) if it has \\(n\\) rows and \\(K\\) columns. Uppercase bold denotes a matrix: \\[ \\mat{A} = \\left[ \\begin{array}{cccc}      a_{11} &amp; a_{12} &amp; \\cdots &amp; a_{1K}  \\\\      a_{21} &amp; a_{22} &amp; \\cdots &amp; a_{2K}  \\\\      \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots  \\\\      a_{n1} &amp; a_{n2} &amp; \\cdots &amp; a_{nK} \\end{array} \\right] \\] We will often need to refer to some generic entry (or cell) of a matrix and we can do this with \\(a_{ik}\\) where this is the entry in row \\(i\\) and column \\(k\\). There is nothing special about these matrices. They are a convenient and concise way to group numbers.   4.6.2 Examples of matrices -One example of a matrix that we’ll use a lot is the design matrix, which has a column of ones (the regression intercept), and then each of the subsequent columns is each independent variable in the regression. \\[ \\mathbf{X} = \\left[ \\begin{array}{cccc}      1 &amp; x_{1,1} &amp; x_{1,2} &amp; x_{1,3}  \\\\      1 &amp; x_{2,1} &amp; x_{2,2} &amp; x_{2,3} \\\\      \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots  \\\\      1 &amp; \\text{exports}_{n} &amp; \\text{age}_n &amp;  \\text{male}_n \\end{array} \\right] \\]    4.7 Vectors A vector is a matrix with only one row or one column. A row vector is a vector with only one row, sometimes called a \\(1 \\times K\\) vector: \\[ \\boldsymbol{\\alpha}=\\left[ \\begin{array}{ccccc}     \\alpha_{1}  &amp; \\alpha_{2} &amp; \\alpha_{3} &amp; \\cdots &amp; \\alpha_{K} \\end{array} \\right] \\] A column vector is a vector with one column and more than one row. Here is a \\(n \\times 1\\) vector: \\[ \\vec{y} = \\left[ \\begin{array}{c}     y_{1}   \\\\     y_{2}  \\\\     \\vdots   \\\\     y_{n} \\end{array} \\right] \\] Unless otherwise stated, we’ll assume that a vector is column vector and vectors will be written with lowercase bold lettering (\\(\\mathbf{b}\\)). Tip note that different fields have different assumptions about whether vectors are row vectors or column vectors by default.   4.8 Vector examples One common vector that we will work with are individual variables, such as the dependent variable, which we will represent as \\(\\vec{y}\\): \\[ \\vec{y} = \\left[ \\begin{array}{c}     y_{1}   \\\\     y_{2}  \\\\     \\vdots   \\\\     y_{n} \\end{array} \\right] \\]   4.9 Transpose There are many operations we’ll do on vectors and matrices, but one is very fundamental: the transpose. The transpose of a matrix \\(\\mathbf{A}\\) is the matrix created by switching the rows and columns of the data and is denoted \\(\\mathbf{A&#39;}\\). That is, the \\(k\\)th column becomes the \\(k\\)th row. \\[\\mathbf{A}=\\left[   \\begin{array}{cc}     a_{11} &amp; a_{12} \\\\     a_{21} &amp; a_{22} \\\\     a_{31} &amp; a_{32} \\\\   \\end{array} \\right] \\,\\, \\mathbf{A&#39;} = \\left[   \\begin{array}{ccc}     a_{11} &amp; a_{21} &amp; a_{31} \\\\     a_{12} &amp; a_{22} &amp; a_{32} \\\\   \\end{array} \\right]\\] If \\(\\mathbf{A}\\) is \\(j \\times k\\), then \\(\\mathbf{A&#39;}\\) will be \\(k \\times j\\).   4.10 Transposing vectors Transposing will turn a \\(k \\times 1\\) column vector into a \\(1 \\times k\\) row vector and vice versa: \\[ \\boldsymbol{\\omega} = \\left[ \\begin{array}{r}     1  \\\\     3  \\\\     2  \\\\     -5 \\end{array} \\right]\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\, \\boldsymbol{\\omega}&#39; = \\left[ \\begin{array}{cccc}     1 &amp; 3 &amp; 2 &amp; -5 \\end{array} \\right]   \\]   4.11 Write matrices as vectors  Sometimes it will be easier to refer to matrices as a group of column or row vectors: As a row vector: \\[ \\mathbf{A} = \\left[   \\begin{array}{ccc} a_{11} &amp;  a_{12} &amp;  a_{13} \\\\ a_{21} &amp;  a_{22} &amp;  a_{23} \\\\   \\end{array} \\right]=\\left[            \\begin{array}{c}              \\mathbf{a}_1&#39; \\\\              \\mathbf{a}_2&#39; \\\\            \\end{array}          \\right]  \\] with row vectors \\(\\mathbf{a}&#39;_1 = \\left[  \\begin{array}{ccc}  a_{11} &amp; a_{12} &amp; a_{13} \\\\  \\end{array}  \\right]\\,\\, \\mathbf{a}_2&#39; = \\left[  \\begin{array}{ccc}  a_{21} &amp; a_{22} &amp; a_{23} \\\\  \\end{array}  \\right]\\) Or we can define it in terms of column vectors: \\[ \\mat{B} = \\left[   \\begin{array}{cc} b_{11} &amp; b_{12} \\\\ b_{21} &amp; b_{22} \\\\ b_{31} &amp; b_{32} \\\\   \\end{array} \\right] = \\left[         \\begin{array}{cc}          \\mathbf{b_1}  &amp; \\mathbf{b_2} \\\\         \\end{array}       \\right]\\] where \\(\\mathbf{b_1}\\) and \\(\\mathbf{b_2}\\) represent the columns of \\(\\mat{B}\\). It should be clear what is what: matrices defined by column will be written horizontally, whereas matrices defined by row will be written vertically with transposes. Also, we’ll use \\(k\\) and \\(j\\) as subscripts for columns of a matrix: \\(\\vec{X}_j\\) or \\(\\vec{x}_k\\), whereas \\(i\\) and \\(t\\) will be used for rows \\(\\vec{x}&#39;_i\\).    4.12 Addition and subtraction  How do we add or subtract matrices and vectors? First, the matrices/vectors need to be comformable, meaning that the dimensions have to be the same. Let \\(\\mathbf{A}\\) and \\(\\mat{B}\\) both be \\(2\\times 2\\) matrices. Then, let \\(\\mathbf{C} = \\mathbf{A} + \\mat{B}\\), where we add each cell together:  \\begin{small} \\[ \\mat{A} + \\mat{B} = \\left[   \\begin{array}{cc}     a_{11} &amp; a_{12} \\\\     a_{21} &amp; a_{22} \\\\   \\end{array} \\right] + \\left[   \\begin{array}{cc}     b_{11} &amp; b_{12} \\\\     b_{21} &amp; b_{22} \\\\   \\end{array} \\right]= \\left[   \\begin{array}{cc}     a_{11} + b_{11} &amp; a_{12} + b_{12} \\\\     a_{21} + b_{21} &amp; a_{22} + b_{22} \\\\   \\end{array} \\right] = \\left[   \\begin{array}{cc}     c_{11} &amp; c_{12} \\\\     c_{21} &amp; c_{22} \\\\   \\end{array} \\right] =\\mathbf{C} \\] \\end{small}   4.13 Scalar multiplication A scalar is a single number: you can think of it sort of like a 1 by 1 matrix. When we multiply a scalar by a matrix, we multiply each element/cell by that scalar: \\begin{small} \\[ \\alpha \\mat{A}=\\alpha \\left[   \\begin{array}{cc}     a_{11} &amp; a_{12} \\\\     a_{21} &amp; a_{22} \\\\   \\end{array} \\right] = \\left[   \\begin{array}{cc}   \\alpha\\times a_{11} &amp; \\alpha\\times a_{12} \\\\    \\alpha\\times a_{21} &amp; \\alpha\\times a_{22} \\\\   \\end{array} \\right] \\] \\end{small}   4.14 The linear model with new notation  Remember that we wrote the linear model as the following for all \\(i \\in [1,\\ldots,n]\\):  \\[y_i = \\beta_0 + x_i\\beta_1 + z_i\\beta_2 + u_i \\]  Imagine we had an \\(n\\) of 4. We could write out each formula:  \\[\\begin{aligned} y_1 &amp;= \\beta_0 + x_{1}\\beta_1 + z_{1}\\beta_2 + u_1 &amp; \\text{(unit 1)} \\\\ y_2 &amp;= \\beta_0 + x_{2}\\beta_1 + z_{2}\\beta_2 + u_2 &amp; \\text{(unit 2)} \\\\ y_3 &amp;= \\beta_0 + x_{3}\\beta_1 + z_{3}\\beta_2 + u_3 &amp; \\text{(unit 3)} \\\\ y_4 &amp;= \\beta_0 + x_{4}\\beta_1 + z_{4}\\beta_2 + u_4 &amp; \\text{(unit 4)} \\\\ \\end{aligned}\\]  We can write this as:  \\[ \\left[   \\begin{array}{c} y_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\\\   \\end{array} \\right] = \\left[   \\begin{array}{c} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\   \\end{array} \\right]\\beta_0 + \\left[   \\begin{array}{c} x_{1} \\\\ x_{2} \\\\ x_{3} \\\\ x_{4} \\\\   \\end{array} \\right]\\beta_1 + \\left[   \\begin{array}{c} z_{1} \\\\ z_{2} \\\\ z_{3} \\\\ z_{4} \\\\   \\end{array} \\right]\\beta_2 + \\left[   \\begin{array}{c} u_{1} \\\\ u_{2} \\\\ u_{3} \\\\ u_{4} \\\\   \\end{array} \\right] \\]  Hopefully it’s clear in this notation that the column vector of the outcomes is a linear combination of the independent variables and the error, with the \\(\\beta\\) coefficients acting as the weights. Can we write this in a more compact form? Yes! Let \\(\\mathbf{X}\\) and \\(\\boldsymbol{\\beta}\\) be the following:  \\[ \\underset{(4 \\times 3)}{\\mathbf{X}} = \\left[   \\begin{array}{ccc} 1 &amp; x_1 &amp; z_1 \\\\ 1 &amp; x_2 &amp; z_2 \\\\ 1 &amp; x_3 &amp; z_3 \\\\ 1 &amp; x_4 &amp; z_4 \\\\   \\end{array} \\right] \\quad \\underset{(3 \\times 1)}{\\boldsymbol{\\beta}} = \\left[ \\begin{array}{c} \\beta_0 \\\\ \\beta_1 \\\\ \\beta_2 \\end{array} \\right] \\]   4.15 Matrix multiplication by a vector We will define multiplication of a matrix by a vector in the following way: \\[ \\left[   \\begin{array}{c} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\   \\end{array} \\right]\\beta_0 + \\left[   \\begin{array}{c} x_{1} \\\\ x_{2} \\\\ x_{3} \\\\ x_{4} \\\\   \\end{array} \\right]\\beta_1 + \\left[   \\begin{array}{c} z_{1} \\\\ z_{2} \\\\ z_{3} \\\\ z_{4} \\\\   \\end{array} \\right]\\beta_2 = \\mathbf{X}\\boldsymbol{\\beta} \\]  Thus, multiplication of a matrix by a vector is the linear combination of the columns of the matrix with the vector elements as weights/coefficients. And the left-hand side here only uses scalars times vectors, which is easy! In general, let’s say that we have a \\(n \\times K\\) matrix \\(\\mat{A}\\) and a \\(K \\times 1\\) column vector \\(\\mathbf{b}\\) (notice that the number of columns of the matrix is the same as the number of rows of the vector) Let \\(\\mathbf{a}_k\\) be the \\(k\\)th column of \\(\\mat{A}\\). Then we can write:  \\[ \\underset{(n \\times 1)}{\\mathbf{c}} = \\mathbf{Ab} = b_1\\mathbf{a}_1 + b_2\\mathbf{a}_2 + \\cdots + b_K\\mathbf{a}_K\\]   4.16 Matrix multiplication  What if, instead of a column vector \\(b\\), we have a matrix \\(\\mat{B}\\) with dimensions \\(K \\times M\\). How do we do multiplication like so \\(\\mat{C} = \\mat{A}\\mat{B}\\)? Each column of the new matrix is matrix by vector multiplication: \\[\\mat{C} = \\left[\\vec{c}_1 \\quad \\vec{c}_2 \\quad \\cdots\\quad \\vec{c}_M \\right] \\qquad \\vec{c}_k = \\mat{A}\\vec{b}_k\\] Thus, each column of \\(\\mathbf{C}\\) is a linear combination of the columns of \\(\\mat{A}\\).    4.17 Special multiplications The inner product of a two column vectors \\(\\mathbf{a}\\) and \\(\\mathbf{b}\\) (of equal dimension, \\(K \\times 1\\)) is the transpose of the first multiplied by the second: \\[\\vec{a}&#39;\\vec{b} = a_1b_1 + a_2b_2 + \\cdots + a_Kb_K\\] This is a special case of the stuff above since \\(\\mathbf{a}&#39;\\) is a matrix with \\(K\\) columns and one row, so the columns of \\(\\mathbf{a}&#39;\\) are scalars. Example: let’s say that we have a vector of residuals, \\(\\mathbf{\\hat{\\epsilon}}\\), then the inner product of the residuals is: \\[ \\mathbf{\\hat{\\hat{\\epsilon}}}&#39;\\mathbf{\\hat{\\hat{\\epsilon}}} = \\left[   \\begin{array}{cccc}     \\hat{\\epsilon}_1 &amp; \\hat{\\epsilon}_2 &amp; \\cdots &amp; \\hat{\\epsilon}_n \\\\   \\end{array} \\right] \\left[   \\begin{array}{c}     \\hat{\\epsilon}_1 \\\\     \\hat{\\epsilon}_2 \\\\     \\vdots \\\\     \\hat{\\epsilon}_n \\\\   \\end{array} \\right] \\] \\[ \\mathbf{\\hat{\\hat{\\epsilon}}}&#39;\\mathbf{\\hat{\\hat{\\epsilon}}} =   \\hat{\\epsilon}_1  \\hat{\\epsilon}_1 +   \\hat{\\epsilon}_2   \\hat{\\epsilon}_2 + \\cdots +   \\hat{\\epsilon}_n   \\hat{\\epsilon}_n= \\sum_{i=1}^n   \\hat{\\epsilon}_i^2 \\] It’s the sum of the squared residuals! We can use the inner product to define matrix multiplication. Let \\(\\mathbf{C} = \\mathbf{AB}\\), then \\[ c_{ij} = \\vec{a}&#39;_i vec{b}_j = a_{i1}b_{1j} + a_{i2}b_{2j} + \\cdots + a_{iK}b_{Kj} \\]   4.18 Special matrices and jargon  \\(\\vec{1}\\) is an \\(n \\times 1\\) column vector of ones (a “ones vector”): \\[\\vec{1}&#39;\\vec{x} = 1\\times x_1 + 1 \\times x_2 + \\cdots + 1\\times x_n = \\sum_{i=1}^n x_i\\]  A square matrix is one with equal numbers of rows and columns. The diagonal of a square matrix are the values in which the row number is equal to the column number: \\(a_{11}\\) or \\(a_{22}\\), etc. \\[\\mat{A}=\\left[   \\begin{array}{ccc}     a_{11} &amp; a_{12} &amp; a_{13} \\\\     a_{21} &amp; a_{22} &amp; a_{23} \\\\     a_{31} &amp; a_{32} &amp; a_{33} \\\\   \\end{array} \\right]\\] The identity matrix, \\(\\mat{I}\\) is a square matrix, with 1s along the diagonal and 0s everywhere else. \\[\\mat{I}=\\left[   \\begin{array}{ccc}     1 &amp; 0 &amp; 0 \\\\     0 &amp; 1 &amp; 0 \\\\     0 &amp; 0 &amp; 1 \\\\   \\end{array} \\right]\\]  The identity matrix multiplied by any matrix returns the matrix: \\(\\mat{A}\\mat{I} = \\mat{A}\\).       "]
]
